#!/usr/bin/env bash

# ───────────────────────────────────────────────────────────────
#                          Power Options
# ───────────────────────────────────────────────────────────────

lock="  Lock"
suspend="  Suspend"
logout="  Logout"
reboot="  Reboot"
shutdown="  Shutdown"

username=" $(whoami)"
messages=("See ya!" "Adiós, amigo!" "Catch you on the flip side!" "Powering down..." "Peace out!")
sendoff="${messages[$((RANDOM % ${#messages[@]}))]}"

# Theme rofi
theme="$HOME/.config/rofi/themes/catppuccin-mocha.rasi"

# ───────────────────────────────────────────────────────────────
#                            Rofi UI
# ───────────────────────────────────────────────────────────────

rofi_cmd() {
    rofi -dmenu \
        -p "$username" \
        -mesg "$sendoff" \
        -theme "$theme"
}

run_rofi() {
    echo -e "$lock\n$suspend\n$logout\n$reboot\n$shutdown" | rofi_cmd
}

# ───────────────────────────────────────────────────────────────
#                        Run Commands
# ───────────────────────────────────────────────────────────────

run_cmd() {
    case "$1" in
        "$shutdown") systemctl poweroff ;;
        "$reboot") systemctl reboot ;;
        "$suspend")
            mpc -q pause 2>/dev/null
            amixer set Master mute
            systemctl suspend
            ;;
        "$logout") pkill -KILL -u "$USER" ;;
        "$lock")
            if command -v betterlockscreen &>/dev/null; then
                betterlockscreen -l
            elif command -v i3lock &>/dev/null; then
                i3lock
            fi
            ;;
    esac
}

# ───────────────────────────────────────────────────────────────
#                          Main Menu
# ───────────────────────────────────────────────────────────────

chosen="$(run_rofi)"
run_cmd "$chosen"
